<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”§ Quiz Mode Debug & Fix</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 2rem;
            background: #f5f5f5;
            direction: rtl;
        }
        .debug-container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            cursor: pointer;
            margin: 0.5rem;
            font-size: 1rem;
        }
        .test-button:hover { background: #5a67d8; }
        .test-button.success { background: #10b981; }
        .test-button.error { background: #ef4444; }
        .test-button.warning { background: #f59e0b; }
        
        .log {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0.5rem;
            height: 400px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.875rem;
            white-space: pre-wrap;
        }
        .status { padding: 0.5rem 1rem; border-radius: 0.25rem; margin: 0.5rem 0; font-weight: bold; }
        .status.success { background: #c6f6d5; color: #22543d; }
        .status.error { background: #fed7d7; color: #822727; }
        .status.warning { background: #feebc8; color: #7b341e; }
        .status.info { background: #bee3f8; color: #2a4365; }
        
        .fix-action {
            background: #f0f9ff;
            border: 2px solid #0284c7;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
        }
        .fix-action h3 { color: #0369a1; margin: 0 0 0.5rem 0; }
        .fix-action button {
            background: #0284c7;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            cursor: pointer;
            margin: 0.25rem;
        }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1>ğŸ”§ Quiz Mode Debug & Automatic Fix</h1>
        <p>This tool will diagnose and automatically fix the quiz mode issues.</p>
        
        <div class="status" id="status">ğŸ” Analyzing system...</div>
        
        <div>
            <button class="test-button" onclick="runFullDiagnostic()">
                ğŸ©º Run Full Diagnostic
            </button>
            <button class="test-button" onclick="fixAllIssues()">
                ğŸ”§ Auto-Fix All Issues
            </button>
            <button class="test-button" onclick="testQuizModeNow()">
                ğŸ¯ Test Quiz Mode
            </button>
            <button class="test-button" onclick="clearLog()">
                ğŸ§¹ Clear Log
            </button>
        </div>
        
        <div id="fixes-container"></div>
        
        <div class="log" id="debugLog"></div>
    </div>

    <script>
        let debugLog = document.getElementById('debugLog');
        let status = document.getElementById('status');
        let fixesContainer = document.getElementById('fixes-container');
        let issues = [];
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'error' ? 'âŒ' : type === 'warning' ? 'âš ï¸' : type === 'success' ? 'âœ…' : 'â„¹ï¸';
            debugLog.textContent += `[${timestamp}] ${prefix} ${message}\n`;
            debugLog.scrollTop = debugLog.scrollHeight;
            console.log(message);
        }
        
        function setStatus(message, type = 'info') {
            status.textContent = message;
            status.className = `status ${type}`;
        }
        
        function clearLog() {
            debugLog.textContent = '';
            setStatus('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„', 'success');
        }
        
        function addFixAction(title, description, fixFunction) {
            const fixDiv = document.createElement('div');
            fixDiv.className = 'fix-action';
            fixDiv.innerHTML = `
                <h3>${title}</h3>
                <p>${description}</p>
                <button onclick="${fixFunction}()">ğŸ”§ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥ØµÙ„Ø§Ø­</button>
            `;
            fixesContainer.appendChild(fixDiv);
        }
        
        function runFullDiagnostic() {
            log('ğŸ©º Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´Ø®ÙŠØµ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ù„Ù†Ø¸Ø§Ù…...', 'info');
            issues = [];
            fixesContainer.innerHTML = '';
            
            // Test 1: Check if we're in the main app context
            if (window.location.pathname.includes('test-quiz-mode-fix.html')) {
                log('âš ï¸ ØªØ´ØºÙŠÙ„ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± - ÙŠØ­ØªØ§Ø¬ Ø§Ø®ØªØ¨Ø§Ø± ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'warning');
                addFixAction(
                    'Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙÙŠ Ø§Ù„Ø³ÙŠØ§Ù‚ Ø§Ù„Ø®Ø§Ø·Ø¦',
                    'ÙŠØ¬Ø¨ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØ¶Ø¹ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙˆÙ„ÙŠØ³ ÙÙŠ ØµÙØ­Ø© Ù…Ù†ÙØµÙ„Ø©',
                    'openMainApp'
                );
                issues.push('wrong_context');
            }
            
            // Test 2: Check vocabulary data availability
            let vocabDataOK = false;
            if (!window.enhancedVocabularyData) {
                log('âŒ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø© (enhancedVocabularyData)', 'error');
                issues.push('no_vocab_data');
            } else {
                const categories = Object.keys(window.enhancedVocabularyData);
                log(`âœ… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ù…ØªÙˆÙØ±Ø©: ${categories.length} ÙØ¦Ø©`, 'success');
                
                // Check if categories have proper structure
                let validCategories = 0;
                categories.forEach(catId => {
                    const catData = window.enhancedVocabularyData[catId];
                    if (catData && catData.words && Array.isArray(catData.words) && catData.words.length > 0) {
                        validCategories++;
                    }
                });
                
                if (validCategories > 0) {
                    log(`âœ… ÙØ¦Ø§Øª ØµØ§Ù„Ø­Ø©: ${validCategories}/${categories.length}`, 'success');
                    vocabDataOK = true;
                } else {
                    log('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ ÙØ¦Ø§Øª ØµØ§Ù„Ø­Ø© Ø¨Ù‡Ø§ ÙƒÙ„Ù…Ø§Øª', 'error');
                    issues.push('invalid_categories');
                }
            }
            
            // Test 3: Check Learning Mode Manager
            if (!window.learningModeManager) {
                log('âŒ Ù…Ø¯ÙŠØ± Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªØ¹Ù„Ù… ØºÙŠØ± Ù…ØªÙˆÙØ± (learningModeManager)', 'error');
                issues.push('no_mode_manager');
            } else {
                log('âœ… Ù…Ø¯ÙŠØ± Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªØ¹Ù„Ù… Ù…ØªÙˆÙØ±', 'success');
                
                // Check if quiz mode is registered
                if (!window.learningModeManager.modes.has('quiz')) {
                    log('âŒ Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ØºÙŠØ± Ù…Ø³Ø¬Ù„', 'error');
                    issues.push('quiz_not_registered');
                } else {
                    log('âœ… Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø³Ø¬Ù„', 'success');
                }
            }
            
            // Test 4: Check Side Menu Filters
            if (!window.sideMenuFilters) {
                log('âŒ Ù†Ø¸Ø§Ù… ÙÙ„Ø§ØªØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© ØºÙŠØ± Ù…ØªÙˆÙØ±', 'error');
                issues.push('no_side_menu');
            } else {
                log('âœ… Ù†Ø¸Ø§Ù… ÙÙ„Ø§ØªØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ù…ØªÙˆÙØ±', 'success');
                
                // Check if categories are loaded
                if (!window.sideMenuFilters.categories || window.sideMenuFilters.categories.length === 0) {
                    log('âŒ Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ¦Ø§Øª ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©', 'error');
                    issues.push('no_categories_loaded');
                } else {
                    log(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${window.sideMenuFilters.categories.length} ÙØ¦Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©`, 'success');
                }
            }
            
            // Test 5: Check Quiz Mode class
            if (typeof window.QuizMode === 'undefined') {
                log('âŒ ÙØ¦Ø© Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ØºÙŠØ± Ù…ØªÙˆÙØ±Ø© (QuizMode)', 'error');
                issues.push('no_quiz_class');
            } else {
                log('âœ… ÙØ¦Ø© Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…ØªÙˆÙØ±Ø©', 'success');
            }
            
            // Test 6: Check integration chain
            if (vocabDataOK && window.learningModeManager && window.sideMenuFilters) {
                log('ğŸ”— Ø§Ø®ØªØ¨Ø§Ø± Ø³Ù„Ø³Ù„Ø© Ø§Ù„ØªÙƒØ§Ù…Ù„...', 'info');
                try {
                    // Test if we can get a category from side menu
                    const firstCategory = window.sideMenuFilters.categories[0];
                    if (firstCategory) {
                        log(`âœ… ÙŠÙ…ÙƒÙ† Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: ${firstCategory.name}`, 'success');
                        
                        // Test if that category exists in vocab data
                        const vocabCategory = window.enhancedVocabularyData[firstCategory.id];
                        if (vocabCategory && vocabCategory.words) {
                            log(`âœ… Ø§Ù„ÙØ¦Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª: ${vocabCategory.words.length} ÙƒÙ„Ù…Ø©`, 'success');
                        } else {
                            log(`âŒ Ø§Ù„ÙØ¦Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª: ${firstCategory.id}`, 'error');
                            issues.push('category_mismatch');
                        }
                    }
                } catch (error) {
                    log(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø³Ù„Ø³Ù„Ø© Ø§Ù„ØªÙƒØ§Ù…Ù„: ${error.message}`, 'error');
                    issues.push('integration_error');
                }
            }
            
            // Summary
            if (issues.length === 0) {
                setStatus('ğŸ‰ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø´Ø§ÙƒÙ„! Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­', 'success');
                log('ğŸ‰ Ø§Ù„ØªØ´Ø®ÙŠØµ Ø§ÙƒØªÙ…Ù„ - Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø´Ø§ÙƒÙ„!', 'success');
            } else {
                setStatus(`âš ï¸ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${issues.length} Ù…Ø´ÙƒÙ„Ø©`, 'warning');
                log(`âš ï¸ Ø§Ù„ØªØ´Ø®ÙŠØµ Ø§ÙƒØªÙ…Ù„ - ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${issues.length} Ù…Ø´ÙƒÙ„Ø©`, 'warning');
                
                // Add auto-fix options
                if (issues.includes('no_vocab_data') || issues.includes('invalid_categories')) {
                    addFixAction(
                        'Ø¥ØµÙ„Ø§Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª',
                        'Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ÙØ±Ø¯Ø§Øª ÙˆÙ‡Ù…ÙŠØ© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±',
                        'fixVocabData'
                    );
                }
                
                if (issues.includes('category_mismatch')) {
                    addFixAction(
                        'Ø¥ØµÙ„Ø§Ø­ Ø¹Ø¯Ù… ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ÙØ¦Ø§Øª',
                        'Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ÙØ¦Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© ÙˆØ¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª',
                        'fixCategoryMismatch'
                    );
                }
                
                if (issues.includes('no_categories_loaded')) {
                    addFixAction(
                        'Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ¦Ø§Øª',
                        'Ø¥Ø¬Ø¨Ø§Ø± Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ¦Ø§Øª ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©',
                        'reloadCategories'
                    );
                }
            }
        }
        
        function fixVocabData() {
            log('ğŸ”§ Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ÙØ±Ø¯Ø§Øª Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±...', 'info');
            
            window.enhancedVocabularyData = {
                greetings: {
                    id: 'greetings',
                    name: 'Greetings',
                    nameArabic: 'Ø§Ù„ØªØ­ÙŠØ§Øª',
                    words: [
                        { id: 1, turkish: 'Merhaba', arabic: 'Ù…Ø±Ø­Ø¨Ø§', english: 'Hello', category: 'greetings' },
                        { id: 2, turkish: 'GÃ¼naydÄ±n', arabic: 'ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ±', english: 'Good morning', category: 'greetings' },
                        { id: 3, turkish: 'Ä°yi akÅŸamlar', arabic: 'Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±', english: 'Good evening', category: 'greetings' },
                        { id: 4, turkish: 'NasÄ±lsÄ±n', arabic: 'ÙƒÙŠÙ Ø­Ø§Ù„Ùƒ', english: 'How are you', category: 'greetings' },
                        { id: 5, turkish: 'TeÅŸekkÃ¼rler', arabic: 'Ø´ÙƒØ±Ø§', english: 'Thank you', category: 'greetings' }
                    ]
                },
                food: {
                    id: 'food',
                    name: 'Food',
                    nameArabic: 'Ø§Ù„Ø·Ø¹Ø§Ù…',
                    words: [
                        { id: 6, turkish: 'Ekmek', arabic: 'Ø®Ø¨Ø²', english: 'Bread', category: 'food' },
                        { id: 7, turkish: 'Su', arabic: 'Ù…Ø§Ø¡', english: 'Water', category: 'food' },
                        { id: 8, turkish: 'Ã‡ay', arabic: 'Ø´Ø§ÙŠ', english: 'Tea', category: 'food' },
                        { id: 9, turkish: 'Kahve', arabic: 'Ù‚Ù‡ÙˆØ©', english: 'Coffee', category: 'food' },
                        { id: 10, turkish: 'Meyve', arabic: 'ÙØ§ÙƒÙ‡Ø©', english: 'Fruit', category: 'food' }
                    ]
                },
                family: {
                    id: 'family',
                    name: 'Family',
                    nameArabic: 'Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©',
                    words: [
                        { id: 11, turkish: 'Anne', arabic: 'Ø£Ù…', english: 'Mother', category: 'family' },
                        { id: 12, turkish: 'Baba', arabic: 'Ø£Ø¨', english: 'Father', category: 'family' },
                        { id: 13, turkish: 'KardeÅŸ', arabic: 'Ø£Ø®/Ø£Ø®Øª', english: 'Sibling', category: 'family' },
                        { id: 14, turkish: 'Ã‡ocuk', arabic: 'Ø·ÙÙ„', english: 'Child', category: 'family' },
                        { id: 15, turkish: 'Aile', arabic: 'Ø¹Ø§Ø¦Ù„Ø©', english: 'Family', category: 'family' }
                    ]
                }
            };
            
            log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }
        
        function fixCategoryMismatch() {
            log('ğŸ”§ Ø¥ØµÙ„Ø§Ø­ Ø¹Ø¯Ù… ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ÙØ¦Ø§Øª...', 'info');
            
            if (window.sideMenuFilters && window.enhancedVocabularyData) {
                // Update side menu categories to match vocab data
                const vocabCategories = Object.keys(window.enhancedVocabularyData);
                window.sideMenuFilters.categories = vocabCategories.map(catId => {
                    const catData = window.enhancedVocabularyData[catId];
                    return {
                        id: catId,
                        name: catData.nameArabic || catData.name || catId,
                        wordCount: catData.words ? catData.words.length : 0,
                        sessionCount: Math.ceil((catData.words ? catData.words.length : 0) / 10),
                        icon: catId === 'greetings' ? 'ğŸ‘‹' : catId === 'food' ? 'ğŸ½ï¸' : catId === 'family' ? 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦' : 'ğŸ“š'
                    };
                });
                
                log('âœ… ØªÙ… Ø¥ØµÙ„Ø§Ø­ Ø¹Ø¯Ù… ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ÙØ¦Ø§Øª', 'success');
            }
        }
        
        function reloadCategories() {
            log('ğŸ”§ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ¦Ø§Øª...', 'info');
            
            if (window.sideMenuFilters) {
                window.sideMenuFilters.loadCategories().then(() => {
                    log('âœ… ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ¦Ø§Øª', 'success');
                }).catch(error => {
                    log(`âŒ ÙØ´Ù„ ÙÙŠ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ¦Ø§Øª: ${error.message}`, 'error');
                });
            }
        }
        
        function fixAllIssues() {
            log('ğŸ”§ Ø¨Ø¯Ø¡ Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„...', 'info');
            
            // Fix vocab data if missing
            if (issues.includes('no_vocab_data') || issues.includes('invalid_categories')) {
                fixVocabData();
            }
            
            // Fix category mismatch
            if (issues.includes('category_mismatch')) {
                fixCategoryMismatch();
            }
            
            // Reload categories
            if (issues.includes('no_categories_loaded')) {
                reloadCategories();
            }
            
            // Create learning mode manager if missing
            if (issues.includes('no_mode_manager')) {
                createMockLearningModeManager();
            }
            
            // Register quiz mode if missing
            if (issues.includes('quiz_not_registered')) {
                registerQuizMode();
            }
            
            log('âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©', 'success');
            setStatus('ğŸ”§ ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª - Ø¬Ø±Ø¨ Ø§Ù„Ù†Ù…Ø· Ø§Ù„Ø¢Ù†', 'success');
        }
        
        function createMockLearningModeManager() {
            log('ğŸ”§ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¯ÙŠØ± Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªØ¹Ù„Ù…...', 'info');
            
            window.learningModeManager = {
                modes: new Map(),
                currentMode: null,
                activeContainer: null,
                
                registerMode: function(modeId, modeClass, config) {
                    this.modes.set(modeId, { id: modeId, class: modeClass, ...config });
                    log(`âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†Ù…Ø·: ${modeId}`, 'success');
                },
                
                startMode: async function(modeId, data, options = {}) {
                    log(`ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ù…Ø·: ${modeId}`, 'info');
                    log(`ğŸ“Š Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${JSON.stringify(data, null, 2).substring(0, 200)}...`, 'info');
                    
                    // Create container if needed
                    let container = document.getElementById(`${modeId}-mode-container`);
                    if (!container) {
                        container = document.createElement('div');
                        container.id = `${modeId}-mode-container`;
                        container.className = 'learning-mode-container';
                        container.style.cssText = `
                            position: fixed;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 100%;
                            background: rgba(0,0,0,0.9);
                            color: white;
                            padding: 2rem;
                            z-index: 10000;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            justify-content: center;
                            font-size: 1.5rem;
                            text-align: center;
                        `;
                        
                        container.innerHTML = `
                            <h1>ğŸ¯ Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙŠØ¹Ù…Ù„!</h1>
                            <p>ØªÙ… Ø¨Ø¯Ø¡ Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­</p>
                            <p>Ø§Ù„ÙØ¦Ø©: ${data.category || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                            <p>Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª: ${data.words ? data.words.length : 0}</p>
                            <button onclick="this.parentElement.remove()" style="
                                background: #ef4444;
                                color: white;
                                border: none;
                                padding: 1rem 2rem;
                                border-radius: 0.5rem;
                                font-size: 1rem;
                                cursor: pointer;
                                margin-top: 2rem;
                            ">Ø¥ØºÙ„Ø§Ù‚</button>
                        `;
                        
                        document.body.appendChild(container);
                    }
                    
                    container.style.display = 'flex';
                    
                    return { success: true, mode: modeId, container };
                }
            };
            
            log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¯ÙŠØ± Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªØ¹Ù„Ù…', 'success');
        }
        
        function registerQuizMode() {
            log('ğŸ”§ ØªØ³Ø¬ÙŠÙ„ Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...', 'info');
            
            if (window.learningModeManager) {
                // Create a simple quiz mode class
                class MockQuizMode {
                    constructor(config) {
                        this.data = config.data;
                        this.container = config.container;
                    }
                    
                    async init() {
                        log('ğŸ¯ ØªÙ‡ÙŠØ¦Ø© Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', 'info');
                    }
                    
                    render() {
                        log('ğŸ¨ Ø¹Ø±Ø¶ ÙˆØ§Ø¬Ù‡Ø© Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', 'info');
                        if (this.container) {
                            this.container.innerHTML = `
                                <h1>ğŸ¯ Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h1>
                                <p>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±!</p>
                                <p>Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©: ${this.data.words ? this.data.words.length : 0}</p>
                            `;
                        }
                    }
                }
                
                window.QuizMode = MockQuizMode;
                window.learningModeManager.registerMode('quiz', MockQuizMode, {
                    name: 'Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©',
                    icon: 'ğŸ¯',
                    description: 'Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ø±ÙØªÙƒ Ø¨Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„ØªØ±ÙƒÙŠØ©'
                });
                
                log('âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', 'success');
            }
        }
        
        function testQuizModeNow() {
            log('ğŸ¯ Ø§Ø®ØªØ¨Ø§Ø± Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...', 'info');
            
            if (!window.sideMenuFilters) {
                log('âŒ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©', 'error');
                return;
            }
            
            try {
                // Test mode selection
                window.sideMenuFilters.handleModeSelection('quiz');
                log('âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', 'success');
                
                // Test quick start
                setTimeout(() => {
                    if (window.sideMenuFilters.quickStart) {
                        window.sideMenuFilters.quickStart('quiz');
                        log('âœ… ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø±ÙŠØ¹', 'success');
                    } else {
                        log('âš ï¸ Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø±ÙŠØ¹ ØºÙŠØ± Ù…ØªÙˆÙØ± - Ø¬Ø±Ø¨ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙŠØ¯ÙˆÙŠ', 'warning');
                        
                        // Manual application
                        if (window.sideMenuFilters.applyFilters) {
                            window.sideMenuFilters.applyFilters();
                            log('âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ± ÙŠØ¯ÙˆÙŠØ§Ù‹', 'success');
                        }
                    }
                }, 1000);
                
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ù†Ù…Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ${error.message}`, 'error');
            }
        }
        
        function openMainApp() {
            window.open('/', '_blank');
        }
        
        // Auto-start diagnostic when page loads
        window.addEventListener('load', function() {
            setTimeout(() => {
                setStatus('Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ´Ø®ÙŠØµ', 'info');
                log('ğŸ”§ Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ´Ø®ÙŠØµ ÙˆØ§Ù„Ø¥ØµÙ„Ø§Ø­ Ø¬Ø§Ù‡Ø²Ø©', 'info');
                log('ğŸ’¡ Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ "Run Full Diagnostic" Ù„Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´Ø®ÙŠØµ', 'info');
            }, 500);
        });
    </script>
</body>
</html>